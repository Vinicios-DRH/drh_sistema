{% extends "base.html" %}

{% block head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
<style>
  :root{--brand-red:#B5121B;--brand-red-600:#9e1119;--glass-bg:rgba(255,255,255,.06);--glass-brd:rgba(255,255,255,.16);--ink-200:#e8eef6}
  body{background:linear-gradient(135deg,#0e1726 0%,#0b2e4f 45%,#0b3a63 100%) fixed;}
  .brand-header{background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,.02));border:1px solid var(--glass-brd);border-radius:16px;color:var(--ink-200);backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);box-shadow:0 10px 30px rgba(0,0,0,.35)}
  .glass-card{background:var(--glass-bg);border:1px solid var(--glass-brd);border-radius:16px;color:var(--ink-200);box-shadow:0 10px 30px rgba(0,0,0,.35)}
  .chip{display:inline-flex;align-items:center;gap:.35rem;padding:.15rem .6rem;font-size:.78rem;border-radius:999px;border:1px solid var(--glass-brd);background:rgba(255,255,255,.06)}
  .small-muted{color:#94a3b8}
</style>
{% endblock %}

{% block body %}
<section class="py-3 py-md-4">
  <div class="container-xxl">

    <div class="brand-header p-3 p-md-4 mb-3">
      <div class="d-flex align-items-center justify-content-between flex-wrap gap-3">
        <div class="d-flex align-items-center gap-3">
          <img src="{{ url_for('static', filename='img/logobm.png') }}" width="56" height="56" class="rounded" alt="CBMAM">
          <div>
            <h1 class="h5 m-0">PAF #{{ paf.id }} — {{ paf.ano_referencia }}</h1>
            <div class="small opacity-75">
              {% if militar %}{{ militar.nome_completo }}{% endif %}
              {% if pg_sigla %} · PG: {{ pg_sigla }}{% endif %}
              {% if obm_sigla %} · OBM: {{ obm_sigla }}{% endif %}
            </div>
          </div>
        </div>
        <div class="d-flex gap-2">
          <a class="btn btn-outline-light" href="{{ url_for('paf.minhas', ano=paf.ano_referencia) }}"><i class="bi bi-arrow-left"></i> Voltar</a>
        </div>
      </div>
    </div>

    {% set meses_full = ["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"] %}
    {% macro mes_nome(v) -%}
      {%- if v is not none and (v|string)|int>=1 and (v|string)|int<=12 -%}
        {{ meses_full[(v|string)|int - 1] }}
      {%- elif v -%}{{ v }}{%- else -%}—{%- endif -%}
    {%- endmacro %}

    <div class="glass-card p-3 p-md-4">
      <div class="mb-2">
        <span class="small-muted">Opções escolhidas:</span><br>
        <span class="chip">{{ mes_nome(paf.opcao_1) }}</span>
        <span class="chip">{{ mes_nome(paf.opcao_2) }}</span>
        <span class="chip">{{ mes_nome(paf.opcao_3) }}</span>
      </div>

      <div class="mb-2">
        <span class="small-muted">Status:</span>
        <strong>{{ paf.status or '—' }}</strong>
      </div>

      <div class="mb-2">
        <span class="small-muted">Mês definido (DRH):</span>
        <strong>{{ mes_nome(paf.mes_definido) }}</strong>
      </div>

      <div class="row g-3 mt-1">
        <div class="col-12 col-md-4">
          <div class="small-muted">Enviado em</div>
          <div>{{ paf.created_at.strftime('%d/%m/%Y %H:%M') if paf.created_at else '—' }}</div>
        </div>
        <div class="col-12 col-md-4">
          <div class="small-muted">Recebido em</div>
          <div>{{ paf.recebido_em.strftime('%d/%m/%Y %H:%M') if paf.recebido_em else '—' }}</div>
        </div>
        <div class="col-12 col-md-4">
          <div class="small-muted">Última atualização</div>
          <div>{{ paf.updated_at.strftime('%d/%m/%Y %H:%M') if paf.updated_at else '—' }}</div>
        </div>
      </div>

      {% if paf.observacoes %}
      <div class="mt-3">
        <div class="small-muted">Observações</div>
        <div>{{ paf.observacoes }}</div>
      </div>
      {% endif %}
    </div>

  </div>
</section>
{% endblock %}
