{% set user_funcao = current_user.funcao_user_id %}
{% set user_obm = current_user.obm1.sigla if current_user.obm1 else '' %}

<nav class="navbar fixed-top">
    <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center" href="{{ url_for('home') }}">
            <img src="{{ url_for('static', filename='img/logobm.png') }}" alt="Logo" style="width:30px; height:auto;">
        </a>
        <button id="buttonNav" class="navbar-toggler" type="button" data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
            <img class="img-responsive" style="width:40px; max-width:100% !important;"
                src="{{ url_for('static', filename='img/menu.png') }}" alt="">
        </button>

        <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar">
            <div class="offcanvas-header">
                <h5 class="offcanvas-title">Menu</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
            </div>

            <div class="offcanvas-body">
                <div class="mb-3">
                    <div>
                        <a href="{{ url_for('perfil', id_usuario=current_user.id) }}"><strong class="offcanvas-title">{{
                                current_user.nome }}</strong></a>
                    </div>

                    <small class="text-muted">
                        {% if current_user.obm1 %}{{ current_user.obm1.sigla }}{% endif %}
                        {% if current_user.obm2 %} - {{ current_user.obm2.sigla }}{% endif %}
                    </small>
                </div>

                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('home') }}">
                            <i class="fas fa-home me-2"></i> InÃ­cio
                        </a>
                    </li>

                    {# Se o usuÃ¡rio Ã© da OBM DRH ou SUPER USER #}
                    {% if user_funcao in [5, 6, 7] %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-id-card me-2"></i> DocumentaÃ§Ã£o
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{{ url_for('gerar_le') }}">ğŸ“„ LicenÃ§a Especial</a>
                            </li>
                            <li><a class="dropdown-item" href="{{ url_for('indeferimento_le') }}">ğŸ“„ Indeferida LicenÃ§a
                                    Especial</a>
                            </li>
                            <li><a class="dropdown-item" href="{{ url_for('gerar_lp') }}">ğŸ“„ LicenÃ§a Paternidade</a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-friends me-2"></i> Militares Ativos
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{{ url_for('militares') }}">ğŸ‘¥ Mapa da ForÃ§a</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('adicionar_militar') }}">â• Adicionar
                                    Militar</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('militares_a_disposicao') }}">ğŸ”„ Militares a
                                    disposiÃ§Ã£o</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('militares_agregados') }}">â– Militares
                                    agregados</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('licenca_especial') }}">ğŸ—“ï¸ LicenÃ§a
                                    Especial</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('lts') }}">ğŸ¥ LicenÃ§a para Tratamento de
                                    SaÃºde</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('gerar_qrcodes') }}"> î‡˜ Gerar QrCodes</a></li>
                        </ul>
                    </li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-friends me-2"></i> Militares Inativos
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{{ url_for('listar_militares_inativos') }}">ğŸ‘¥ Mapa da
                                    ForÃ§a Inativos</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('adicionar_militar_inativo') }}">â• Adicionar
                                    Militar Inativo</a></li>
                        </ul>
                    </li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-id-card me-2"></i> Motoristas
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{{ url_for('adicionar_motorista') }}">â• Adicionar
                                    Motorista</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('motoristas') }}">ğŸ“ Mapa Motoristas</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('listar_cnhs') }}">ğŸ“„ Listar CNHs</a></li>
                        </ul>
                    </li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-dollar-sign me-2"></i> Pagadoria
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{{ url_for('novo_vencimento') }}">ğŸ“ Nova Tabela de
                                    Vencimentos</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('calcular_impacto') }}">ğŸ“ˆ CÃ¡lculo de
                                    Impacto</a></li>
                        </ul>
                    </li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-id-card me-2"></i> ConvocaÃ§Ã£o Concurso
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{{ url_for('relatorio_convocacao') }}">ğŸ“„ RelatÃ³rio
                                    ConvocaÃ§Ã£o </a></li>
                            <li><a class="dropdown-item" href="{{ url_for('adicionar_convocacao') }}">â• Adicionar
                                    Convocado</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('importar_convocados') }}">â• Importar
                                    Convocados</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('controle_convocacao') }}">ğŸ“„ Controle
                                    Convocacao</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('dashboard') }}">ğŸ“ˆ Dashboard</a></li>
                        </ul>
                    </li>
                    {% endif %}
                    {% set funcao = current_user.funcao_user_id %}
                    {% set obm = current_user.obm_id_1 %}

                    {% if (funcao == 2 and obm == 26) or funcao == 6 or obm == 37 %}
                    <!-- ACESSO TOTAL -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-graduate me-2"></i> Alunos Soldados
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{{ url_for('ficha_aluno') }}">â• Nova Ficha</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('listar_fichas') }}">ğŸ“„ Ver Fichas</a>
                            </li>
                            <li><a class="dropdown-item" href="{{ url_for('listar_alunos_inativos') }}">ğŸ“„ Ver Alunos
                                    Inativos</a>
                            </li>
                            <li><a class="dropdown-item" href="{{ url_for('listar_alunos_em_lts') }}">ğŸ“„ Ver Alunos
                                    em LTS</a>
                            </li>
                            <li><a class="dropdown-item"
                                    href="{{ url_for('listar_por_pelotao', slug='rio-javari') }}">ğŸ“Š PelotÃ£o Rio
                                    Javari</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('listar_por_pelotao', slug='rio-jurua') }}">ğŸ“Š
                                    PelotÃ£o Rio
                                    JuruÃ¡</a></li>
                            <li><a class="dropdown-item"
                                    href="{{ url_for('listar_por_pelotao', slug='rio-japura') }}">ğŸ“Š PelotÃ£o Rio
                                    JapurÃ¡</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('listar_por_pelotao', slug='rio-purus') }}">ğŸ“Š
                                    PelotÃ£o Rio
                                    Purus</a></li>
                        </ul>
                    </li>

                    {% elif funcao == 8 %}
                    <!-- Monitor JAVARI -->
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('listar_por_pelotao', slug='rio-javari') }}">ğŸ“Š PelotÃ£o
                            Rio Javari</a>
                    </li>

                    {% elif funcao == 9 %}
                    <!-- Monitor JURUÃ -->
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('listar_por_pelotao', slug='rio-jurua') }}">ğŸ“Š PelotÃ£o
                            Rio JuruÃ¡</a>
                    </li>

                    {% elif funcao == 10 %}
                    <!-- Monitor JAPURÃ -->
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('listar_por_pelotao', slug='rio-japura') }}">ğŸ“Š PelotÃ£o
                            Rio JapurÃ¡</a>
                    </li>

                    {% elif funcao == 11 %}
                    <!-- Monitor PURUS -->
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('listar_por_pelotao', slug='rio-purus') }}">ğŸ“Š PelotÃ£o
                            Rio Purus</a>
                    </li>
                    {% endif %}

                    {% if user_funcao == 6 %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-tools me-2"></i> Utilidades
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{{ url_for('usuarios') }}">ğŸ‘¤ UsuÃ¡rios</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('criar_conta') }}">â• Adicionar UsuÃ¡rio</a>
                        </ul>
                    </li>
                    {% endif %}

                    {# Acesso Ã s FÃ©rias separado conforme perfil #}
                    {% if user_funcao in [1, 2, 7] %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('exibir_ferias_chefe') }}">FÃ©rias</a>
                    </li>
                    {% endif %}

                    {% if user_funcao == 6 %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('exibir_ferias') }}">FÃ©rias</a>
                    </li>
                    {% endif %}

                    {# BotÃ£o de sair #}
                    {% if current_user.is_authenticated %}
                    <li class="nav-item mt-3">
                        <a class="btn btn-danger w-100" href="{{ url_for('sair') }}">
                            <i class="fas fa-sign-out-alt"></i> Sair
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </div>
</nav>

<!-- Estilos Extras para deixar o Offcanvas mais bonito -->
<style>
    .offcanvas-body ul.navbar-nav {
        padding-top: 15px;
    }

    .offcanvas-body li.nav-item {
        margin-bottom: 10px;
    }
</style>